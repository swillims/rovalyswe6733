language: dart

dart:
  - stable

cache:
  directories:
    - $HOME/.pub-cache

before_install:
  - git clone https://github.com/flutter/flutter.git -b stable --depth 1
  - export PATH="$PATH:`pwd`/flutter/bin"
  - flutter doctor
  - flutter config --enable-web
  - flutter upgrade
  - export NVM_DIR="$HOME/.nvm"
  - [ -s "$NVM_DIR/nvm.sh" ] && \. "$NVM_DIR/nvm.sh" || curl -o- https://raw.githubusercontent.com/nvm-sh/nvm/v0.39.7/install.sh | bash
  - source "$NVM_DIR/nvm.sh"
  - nvm install 18
  - nvm use 18
  - node -v
  - npm -v
  - npm install -g firebase-tools

install:
  - flutter pub get

script:
  - flutter build web --release

deploy:
  provider: script
  script: firebase deploy --project swe6733wc --token "$FIREBASE_TOKEN" # I have a string literal I can use if this doesn't work
  skip_cleanup: true
  on:
    branch: dev
